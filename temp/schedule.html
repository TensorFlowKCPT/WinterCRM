<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <div>
        {% for emp in data %}
        <button>{{ emp }}</button>
        {% endfor %}
    </div>
    <div class="schedule">
    </div>

    <div class="status">
        <input type="radio" id="option1" name="radioGroup" value="option1">
        <label style="background-color: blue;" for="option1">Работает</label>
        
        <input type="radio" id="option2" name="radioGroup" value="option2">
        <label style="background-color: red;" for="option2">Болеет</label>
        
        <input type="radio" id="option3" name="radioGroup" value="option3">
        <label style="background-color: green;" for="option3">Отпуск</label>
    </div>

    <div>
        <button id="saveButton">Сохранить</button>
        <button>Изменить</button>
    </div>

    <form method="POST" action="/schedule">
        <label for="password">Пароль:</label>
        <input type="password" id="password" name="password" required>
        <br>
        <input type="submit" value="Отправить">
    </form>
<script>
// Получаем ссылки на радиокнопки и ячейки таблицы

// Назначаем обработчик события для кнопки "Сохранить"
var saveButton = document.getElementById('saveButton');
saveButton.addEventListener('click', function () {
    var tableHTML = document.querySelector('.schedule').outerHTML
    // Отправляем данные на сервер
    fetch('/save', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/x-www-form-urlencoded',
        },
        body: 'table=' + encodeURIComponent(tableHTML),
    })
        .then(function (response) {
            if (response.status === 200) {
                alert('Таблица сохранена на сервере.');
            }
        })
        .catch(function (error) {
            console.error('Ошибка при отправке данных: ', error);
        });
});

var scheduleDiv = document.querySelector('.schedule');
function schedtojson(dv){
    var json = {"name":None, 'month':None} 
    
}
document.querySelectorAll('button').forEach(function(button) {
    button.addEventListener('click', function() {
        const employee_id = button.innerText; // Предполагая, что текст на кнопке - это ID сотрудника
        fetch('/get_schedule', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ employee_id: employee_id })
        })
        .then(response => response.text()) // Ожидаем текстовый ответ
        .then(data => {
            console.log(data)
            const scheduleContainer = document.getElementsByClassName("schedule");
            scheduleContainer[0].innerHTML = data;
            var radioButtons = document.querySelectorAll('input[type="radio"]');
var tableCells = document.querySelectorAll('.cell');
// Назначаем обработчик события для каждой радиокнопки
radioButtons.forEach(function(radioButton, index) {
    radioButton.addEventListener('change', function() {
        // Если радиокнопка выбрана, сохраняем ее цвет
        if (radioButton.checked) {
            var selectedColor = radioButton.nextElementSibling.style.backgroundColor;

            // Назначаем обработчик события для каждой ячейки таблицы
            tableCells.forEach(function(cell) {
                cell.addEventListener('click', function() {
                    // Закрашиваем ячейку выбранным цветом
                    cell.style.backgroundColor = selectedColor;
                });
            });
        }
    });
})
        })
        .catch(error => {
            console.error('Произошла ошибка:', error);
        });
    });
});
</script>
</body>
</html>